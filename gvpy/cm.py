# -*- coding: utf-8 -*-
"""Registers a number of colormaps in Matplotlib.

The following colormaps are added:

- ocean4jbm
- ocean4jbm_r

Thanks to [John Mickett](http://apl.uw.edu/people/profile.php?last_name=Mickett&first_name=John) for `ocean4jbm`!

- petroff_class
Thanks to [Matthew
Petroff](https://mpetroff.net/2023/05/an-improved-cmb-map-colormap/) for a
variation of the Planck colormap.
"""

import matplotlib as mpl
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.colors import LinearSegmentedColormap, ListedColormap

ocean4jbm = np.array(
    [
        [0.19532446362340, 0.13796378116395, 0.15719499584055],
        [0.19923095289586, 0.14112254081445, 0.16238593878581],
        [0.20313744216833, 0.14430433496405, 0.16755384723197],
        [0.20704393144080, 0.14747625718546, 0.17273162760631],
        [0.21095042071327, 0.15062843555050, 0.17792915183702],
        [0.21485690998574, 0.15379377648646, 0.18311351349682],
        [0.21876339925820, 0.15697557063605, 0.18828142194298],
        [0.22266988853067, 0.16014091157201, 0.19346578360278],
        [0.22657637780314, 0.16329308993705, 0.19866330783349],
        [0.23048286707561, 0.17274355848413, 0.21077118179371],
        [0.23438935634808, 0.18534317212223, 0.22633423061868],
        [0.23829584562054, 0.19794278576033, 0.24189727944366],
        [0.24220233489301, 0.21054239939843, 0.25746032826864],
        [0.24610882416548, 0.22316833817836, 0.27302337709361],
        [0.25001531343795, 0.23579756760102, 0.28858642591859],
        [0.25392180271042, 0.24839718123912, 0.30414947474356],
        [0.25782829198288, 0.26099679487722, 0.31971252356854],
        [0.26173478125535, 0.27359640851532, 0.33527557239352],
        [0.26564127052782, 0.28619602215342, 0.35083862121849],
        [0.26954775980029, 0.29879563579152, 0.36640167004347],
        [0.27345424907276, 0.31139524942962, 0.38196471886844],
        [0.27736073834522, 0.32399486306772, 0.39752776769342],
        [0.28126722761769, 0.33659447670582, 0.41310397908931],
        [0.28517371689016, 0.34919409034392, 0.42869664369884],
        [0.28908020616263, 0.36179370398202, 0.44427285509473],
        [0.29298669543510, 0.37439331762012, 0.45983590391970],
        [0.29689318470756, 0.38701267511459, 0.47539895274468],
        [0.30079967398003, 0.39964190453724, 0.49096200156966],
        [0.30470616325250, 0.41224809946080, 0.50652505039463],
        [0.30861265252497, 0.42484771309890, 0.52208809921961],
        [0.31251914179744, 0.43744732673700, 0.53765114804458],
        [0.31642563106990, 0.45004694037510, 0.55321419686956],
        [0.32033212034237, 0.46264655401320, 0.56877724569453],
        [0.32423860961484, 0.47524616765130, 0.58434029451951],
        [0.32814509888731, 0.48784578128940, 0.59990334334449],
        [0.33205158815977, 0.50044539492750, 0.61151103961000],
        [0.33595807743224, 0.51304500856560, 0.60927500191740],
        [0.33986456670471, 0.52564462220370, 0.60703896422479],
        [0.34377105597718, 0.53824423584180, 0.60480292653219],
        [0.35138939024721, 0.54889578898472, 0.60258005141050],
        [0.36364753076420, 0.55711226650868, 0.60037362950245],
        [0.37590567128119, 0.56531229081899, 0.59815075438076],
        [0.38816381179818, 0.57349915255839, 0.59591471668816],
        [0.40042195231517, 0.58168601429779, 0.59367867899556],
        [0.41268009283216, 0.58987287603719, 0.59144264130296],
        [0.42493823334915, 0.59808277227568, 0.58920660361035],
        [0.43719637386613, 0.60629924979964, 0.58697056591775],
        [0.44945451438312, 0.61448940218177, 0.58473452822515],
        [0.46171265490011, 0.62267626392117, 0.58249849053255],
        [0.47397079541710, 0.63086312566056, 0.58026245283994],
        [0.48623222657682, 0.63905327804269, 0.57802970579007],
        [0.49851998287836, 0.64726975556665, 0.57582328388202],
        [0.51080115789445, 0.65547965180514, 0.57361028068852],
        [0.52305929841144, 0.66366651354454, 0.57137424299591],
        [0.53531743892843, 0.67185337528394, 0.56913820530331],
        [0.54757557944542, 0.68004023702334, 0.56690216761071],
        [0.55983371996241, 0.68824026133365, 0.56466612991810],
        [0.57209186047940, 0.69645673885761, 0.56243009222550],
        [0.58435000099638, 0.70465676316792, 0.56019405453290],
        [0.59660814151337, 0.71284362490732, 0.55795801684030],
        [0.60886628203036, 0.72103048664672, 0.55572197914769],
        [0.62112442254735, 0.72921734838612, 0.55348594145509],
        [0.63338256306434, 0.73742724462462, 0.55127293826159],
        [0.64564070358133, 0.74564372214857, 0.54906651635354],
        [0.65789884409832, 0.75383387453070, 0.54683376930366],
        [0.67015698461531, 0.76202073627010, 0.54459773161106],
        [0.68241512513230, 0.77023721379405, 0.54236169391846],
        [0.69467326564929, 0.77845040067528, 0.54012565622586],
        [0.70693140616627, 0.78663726241468, 0.53788961853325],
        [0.71871569413038, 0.79482412415408, 0.53751608462489],
        [0.72884149815941, 0.80301098589347, 0.54366131396136],
        [0.73897717411662, 0.81120771956106, 0.54980654329784],
        [0.74913259393020, 0.81942419708501, 0.55595177263431],
        [0.75927485117287, 0.82565312640105, 0.56209700197078],
        [0.76940065520190, 0.82939762045719, 0.56824223130726],
        [0.77952645923092, 0.83314211451334, 0.57438746064373],
        [0.78965226325995, 0.83688660856948, 0.58053268998020],
        [0.79977806728897, 0.84063110262562, 0.58667791931668],
        [0.80990387131800, 0.84437559668177, 0.59282314865315],
        [0.82002967534703, 0.84814312523701, 0.59894534349052],
        [0.83015547937605, 0.85191723507771, 0.60506095704244],
        [0.84030760854691, 0.85566501977658, 0.61120289573619],
        [0.85046302836049, 0.85940951383272, 0.61734812507266],
        [0.86058883238951, 0.86315400788887, 0.62349335440913],
        [0.87071463641854, 0.86689850194501, 0.62963858374561],
        [0.88084044044757, 0.87064299600115, 0.63578381308208],
        [0.89096624447659, 0.87439407134275, 0.64192904241855],
        [0.90109204850562, 0.87816818118345, 0.64807427175503],
        [0.91121785253464, 0.88193241909596, 0.65421950109150],
        [0.92134365656367, 0.88567691315211, 0.66036473042797],
        [0.93146946059270, 0.88942140720825, 0.66650995976445],
        [0.94159526462172, 0.89316590126439, 0.67265518910092],
        [0.95173752186439, 0.89691039532054, 0.67878396522375],
        [0.96189294167797, 0.90065488937668, 0.68489957877567],
        [0.96890342621721, 0.90441912728919, 0.69103493618396],
        [0.97512274097377, 0.90819323712989, 0.69718016552043],
        [0.98134205573033, 0.91194431247149, 0.70332539485691],
        [0.98756137048688, 0.91568880652764, 0.70947062419338],
        [0.99378068524344, 0.91943330058378, 0.71561585352985],
    ]
)


def RGBToPyCmap(rgbdata):
    """
    Convert an array of RGB to Matplotlib colormap.

    Parameters
    ----------
    rgbdata : array-like
        Nx3 array with RGB data.

    Returns
    -------
    dict
        Colors in Matplotlib format.
    """
    nsteps = rgbdata.shape[0]
    stepaxis = np.linspace(0, 1, nsteps)

    rdata = []
    gdata = []
    bdata = []
    for istep in range(nsteps):
        r = rgbdata[istep, 0]
        g = rgbdata[istep, 1]
        b = rgbdata[istep, 2]
        rdata.append((stepaxis[istep], r, r))
        gdata.append((stepaxis[istep], g, g))
        bdata.append((stepaxis[istep], b, b))

    mpl_data = {"red": rdata, "green": gdata, "blue": bdata}

    return mpl_data


mpl_data = RGBToPyCmap(ocean4jbm)
if "ocean4jbm" not in mpl.colormaps:
    mpl.colormaps.register(
        cmap=LinearSegmentedColormap("ocean4jbm", mpl_data, ocean4jbm.shape[0])
    )

mpl_data_r = RGBToPyCmap(ocean4jbm[::-1, :])
if "ocean4jbm_r" not in mpl.colormaps:
    mpl.colormaps.register(
        cmap=LinearSegmentedColormap("ocean4jbm_r", mpl_data_r, ocean4jbm.shape[0])
    )

cm_type = "diverging"
cm_data = [[0.36564336,0.03824246,0.6703986 ],
           [0.36619884,0.06164569,0.67734225],
           [0.36686374,0.08007549,0.68427124],
           [0.36746875,0.09594009,0.69128012],
           [0.36803395,0.11010757,0.69835712],
           [0.36850535,0.12311581,0.70553407],
           [0.36894665,0.13519639,0.71277297],
           [0.36928457,0.1466065 ,0.72011783],
           [0.36955583,0.1574486 ,0.72754632],
           [0.36976061,0.16782188,0.73505781],
           [0.36988253,0.17781117,0.74266199],
           [0.36991847,0.18747448,0.75036028],
           [0.3698651 ,0.19685795,0.75815406],
           [0.36971876,0.20599894,0.76604477],
           [0.36947556,0.21492822,0.77403381],
           [0.36913127,0.22367149,0.78212262],
           [0.36869648,0.2322442 ,0.79030255],
           [0.36815662,0.2406697 ,0.79858138],
           [0.36747672,0.24897526,0.80698047],
           [0.36667909,0.25716351,0.81548262],
           [0.36575406,0.2652481 ,0.82409168],
           [0.36472754,0.27322952,0.83278726],
           [0.36352773,0.28113847,0.84161447],
           [0.3621795 ,0.28897272,0.85055293],
           [0.36070144,0.29677941,0.85945011],
           [0.35899872,0.30463981,0.86820776],
           [0.35710019,0.31258909,0.87666439],
           [0.35495425,0.32060662,0.88493697],
           [0.35254605,0.32870972,0.89297233],
           [0.34987071,0.33691407,0.90070324],
           [0.34695188,0.34523144,0.90803318],
           [0.34381289,0.35368272,0.91483464],
           [0.34042603,0.36227087,0.92110078],
           [0.33681641,0.37100824,0.92672222],
           [0.33303167,0.37990221,0.93157706],
           [0.32917049,0.38895531,0.93550055],
           [0.32539892,0.39816027,0.93829119],
           [0.32184012,0.40748618,0.93989753],
           [0.31871233,0.41688278,0.94025096],
           [0.31627694,0.42627919,0.93934309],
           [0.3149608 ,0.43560009,0.9370309 ],
           [0.31480018,0.44474367,0.93374168],
           [0.31589377,0.45364619,0.92969514],
           [0.31830555,0.46226521,0.92506203],
           [0.32194971,0.47059009,0.92003441],
           [0.32662531,0.47861937,0.91488726],
           [0.33218835,0.4863724 ,0.9097298 ],
           [0.33849728,0.49387348,0.90463808],
           [0.34542107,0.50114698,0.89967157],
           [0.35284154,0.50821605,0.8948793 ],
           [0.36065245,0.51510176,0.8903074 ],
           [0.36881564,0.52182639,0.88590423],
           [0.37729214,0.52840559,0.88164974],
           [0.3859451 ,0.5348558 ,0.87766323],
           [0.39473915,0.54119768,0.87390053],
           [0.4036399 ,0.547438  ,0.87039381],
           [0.41272871,0.55358379,0.86698839],
           [0.42176859,0.55967617,0.8638402 ],
           [0.43076813,0.56572769,0.86088495],
           [0.43974164,0.57173958,0.85811225],
           [0.44867663,0.57771888,0.85552106],
           [0.45757459,0.58366929,0.85310556],
           [0.46644735,0.58959162,0.85085747],
           [0.47528695,0.59549116,0.84877571],
           [0.48409344,0.60137136,0.84685516],
           [0.49287636,0.6072328 ,0.84508955],
           [0.50163164,0.61307935,0.84347695],
           [0.5103578 ,0.61891431,0.84201364],
           [0.51906253,0.62473813,0.84069477],
           [0.52774484,0.63055356,0.83951764],
           [0.53640197,0.63636376,0.83847975],
           [0.5450401 ,0.64216918,0.83757741],
           [0.55366061,0.64797158,0.83680733],
           [0.56225974,0.65377411,0.83616798],
           [0.57084241,0.65957717,0.83565665],
           [0.57941182,0.66538177,0.83526958],
           [0.58796336,0.67119103,0.83500619],
           [0.59650112,0.67700533,0.83486418],
           [0.60502944,0.68282508,0.83483983],
           [0.61354312,0.68865333,0.83493322],
           [0.62204568,0.69449045,0.83514225],
           [0.63054208,0.70033636,0.83546344],
           [0.63902676,0.70619404,0.83589731],
           [0.64750275,0.71206375,0.83644187],
           [0.6559753 ,0.71794504,0.83709388],
           [0.66443856,0.72384071,0.83785414],
           [0.67289515,0.72975086,0.83872068],
           [0.68135023,0.73567466,0.83969043],
           [0.68979768,0.74161462,0.84076425],
           [0.69823969,0.74757047,0.84194008],
           [0.70668084,0.75354093,0.84321482],
           [0.71511469,0.75952796,0.84458912],
           [0.7235428 ,0.76553065,0.84606054],
           [0.73196863,0.77154702,0.84762574],
           [0.7403851 ,0.77757808,0.84928465],
           [0.74879279,0.78362176,0.85103409],
           [0.75719329,0.789675  ,0.85286997],
           [0.76557838,0.79573718,0.85479095],
           [0.77394699,0.80180443,0.85679248],
           [0.78229789,0.80787186,0.85886908],
           [0.79062095,0.81393642,0.86101736],
           [0.79891256,0.81999148,0.86323067],
           [0.80716748,0.82602951,0.86550136],
           [0.81537269,0.83204396,0.8678232 ],
           [0.82353154,0.83802286,0.87016409],
           [0.83160557,0.8439612 ,0.8725558 ],
           [0.83960122,0.84984363,0.87494609],
           [0.84749527,0.85565748,0.87734131],
           [0.85525618,0.86138961,0.87976041],
           [0.86288734,0.86701942,0.88214262],
           [0.87035925,0.87252971,0.88449168],
           [0.87764716,0.87790093,0.88679486],
           [0.88471123,0.88311485,0.88906265],
           [0.89152455,0.88815074,0.89126355],
           [0.89803857,0.8929934 ,0.89337861],
           [0.90416586,0.89764196,0.89538847],
           [0.90979092,0.90211772,0.89716136],
           [0.91488842,0.90643265,0.89830616],
           [0.91974016,0.91048316,0.89836362],
           [0.92462006,0.91411985,0.89734592],
           [0.9294992 ,0.91729045,0.89550487],
           [0.93425803,0.91999381,0.89297159],
           [0.93879064,0.92223224,0.88982271],
           [0.94301782,0.92400396,0.88610929],
           [0.94692503,0.92529829,0.88175442],
           [0.95046354,0.92611058,0.8768055 ],
           [0.95360573,0.9264362 ,0.87127694],
           [0.95637753,0.92626544,0.86506681],
           [0.95837625,0.92579724,0.85778678],
           [0.95928016,0.92507492,0.85039317],
           [0.95971708,0.9238837 ,0.84253778],
           [0.95970896,0.92223227,0.83417682],
           [0.95927154,0.9201327 ,0.82530966],
           [0.95841461,0.91760036,0.81597618],
           [0.95717045,0.9146527 ,0.80613766],
           [0.95555276,0.91131016,0.79584417],
           [0.95358086,0.90759507,0.78513253],
           [0.95127885,0.90353112,0.77402745],
           [0.94867189,0.89914308,0.76255479],
           [0.94579776,0.89445556,0.75069145],
           [0.94266922,0.88949485,0.73851833],
           [0.93931514,0.88428616,0.72604882],
           [0.93574837,0.87885531,0.71335936],
           [0.93200904,0.87322519,0.70040985],
           [0.92812679,0.86741813,0.68719748],
           [0.9241069 ,0.86145721,0.6738127 ],
           [0.91996241,0.85536354,0.66030659],
           [0.91575031,0.849152  ,0.64654082],
           [0.91145012,0.84284351,0.63268775],
           [0.90708933,0.83645239,0.61871334],
           [0.90269388,0.82999107,0.60458109],
           [0.89824502,0.8234757 ,0.59043113],
           [0.8937979 ,0.81691151,0.576089  ],
           [0.88932408,0.81031282,0.56171952],
           [0.88485184,0.80368504,0.54724443],
           [0.88038281,0.79703579,0.53268959],
           [0.87591545,0.79037205,0.51808837],
           [0.87147171,0.78369597,0.50336914],
           [0.86703056,0.77701564,0.48863686],
           [0.86262501,0.77032927,0.47376218],
           [0.85822481,0.7636452 ,0.45888135],
           [0.8540224 ,0.75687712,0.44401934],
           [0.84994998,0.75007265,0.42891725],
           [0.84610718,0.743168  ,0.41387597],
           [0.84240048,0.7362263 ,0.39853937],
           [0.83896035,0.72916099,0.38333779],
           [0.83568984,0.72203607,0.36789697],
           [0.83265306,0.71480706,0.35242998],
           [0.82986886,0.7074624 ,0.33692401],
           [0.82729566,0.70002551,0.32122794],
           [0.82499496,0.69244637,0.30566751],
           [0.82294299,0.68473852,0.29010343],
           [0.82110912,0.67691324,0.27450308],
           [0.8195042 ,0.6689514 ,0.25906015],
           [0.8181347 ,0.66083829,0.24392859],
           [0.8169188 ,0.65261545,0.22899619],
           [0.81582552,0.64429232,0.2143277 ],
           [0.81483591,0.63586778,0.20013635],
           [0.81391221,0.62735542,0.18655143],
           [0.81298347,0.61879862,0.1733923 ],
           [0.8119973 ,0.6102256 ,0.16067375],
           [0.81098915,0.60160859,0.14869384],
           [0.80988169,0.59299779,0.13728437],
           [0.80865267,0.58441443,0.12621663],
           [0.80734223,0.57582826,0.11584065],
           [0.80590129,0.56727574,0.10596112],
           [0.80430497,0.55878229,0.09624162],
           [0.80264034,0.55028081,0.08743798],
           [0.80081902,0.5418474 ,0.07863278],
           [0.7989046 ,0.53343178,0.07046359],
           [0.79686075,0.52506793,0.06246155],
           [0.79471344,0.51673661,0.05487673],
           [0.79245473,0.50844774,0.04753161],
           [0.79009689,0.50019331,0.04052117],
           [0.78763469,0.49198078,0.03389349],
           [0.78508912,0.48379343,0.02830079],
           [0.78243617,0.4756559 ,0.02318967],
           [0.77972456,0.46752438,0.01917356],
           [0.77689528,0.45945708,0.01519809],
           [0.77403572,0.45137109,0.01246466],
           [0.77107145,0.44334031,0.00973639],
           [0.76804301,0.43532432,0.00763024],
           [0.76493933,0.42733478,0.00591504],
           [0.7617481 ,0.41938794,0.00420337],
           [0.75853849,0.41141213,0.0033692 ],
           [0.7552454 ,0.40347583,0.00244733],
           [0.75187756,0.39556601,0.00177104],
           [0.74847247,0.38764635,0.00151969],
           [0.74499492,0.37975583,0.00116906],
           [0.74148068,0.37185227,0.00121462],
           [0.73790381,0.36396218,0.00139839],
           [0.73426368,0.35609028,0.00147662],
           [0.73060386,0.34818298,0.00196516],
           [0.72687529,0.3402928 ,0.00247171],
           [0.72309107,0.33240879,0.00286992],
           [0.71928655,0.32448327,0.00358897],
           [0.71542315,0.31655882,0.00433229],
           [0.71151031,0.30862681,0.00496667],
           [0.70756174,0.30066292,0.00575596],
           [0.70357748,0.2926634 ,0.00666982],
           [0.6995488 ,0.28463987,0.00747549],
           [0.69545632,0.27660981,0.00821601],
           [0.69136259,0.26848445,0.00924911],
           [0.68721138,0.26033654,0.01013625],
           [0.68309243,0.25204082,0.01108817],
           [0.67877534,0.24388621,0.01202275],
           [0.67447313,0.23559013,0.01308795],
           [0.67018246,0.22714526,0.01416322],
           [0.66576011,0.21873901,0.01527521],
           [0.66128612,0.21025044,0.01648803],
           [0.65683456,0.20155561,0.01773209],
           [0.65223786,0.19289594,0.01901698],
           [0.64760001,0.18409423,0.02042929],
           [0.64299673,0.17499925,0.0219    ],
           [0.63816746,0.16604275,0.02342825],
           [0.63334856,0.15678584,0.02504095],
           [0.62848057,0.14729279,0.02680526],
           [0.62346031,0.13774188,0.02867714],
           [0.61847313,0.1276934 ,0.03068049],
           [0.6132222 ,0.11776301,0.03282774],
           [0.60803448,0.1071103 ,0.035157  ],
           [0.60254662,0.09658346,0.03768732],
           [0.59708303,0.08519269,0.04046173],
           [0.59130734,0.07382275,0.04339443],
           [0.58542918,0.06164768,0.04650729],
           [0.57933385,0.04881393,0.04987643],
           [0.57286593,0.03590682,0.05343047],
           [0.56610835,0.02419387,0.05720588],
           [0.55896508,0.0147601 ,0.0611294 ],
           [0.55134596,0.00796559,0.06509284],
           [0.54315429,0.0041923 ,0.0688823 ],
           [0.53452529,0.00268023,0.07231017],
           [0.5255577 ,0.00288671,0.07520117],
           [0.51635152,0.00426125,0.07755282],
           [0.50697827,0.00643002,0.07930752],
           [0.49739886,0.00948432,0.08058416]]
if "petroff_class" not in mpl.colormaps:
    mpl.colormaps.register(ListedColormap(cm_data, name="petroff_class"))

if __name__ == "__main__":
    XX, YY = np.meshgrid(np.linspace(0, 1, 100), np.linspace(0, 1, 100))
    ZZ = np.sqrt(XX**2 + YY**2)

    plt.figure()
    plt.imshow(ZZ, cmap="ocean4jbm")
    plt.colorbar()

    plt.figure()
    plt.imshow(ZZ, cmap="ocean4jbm_r")
    plt.colorbar()

    plt.show()
